(function(t){function e(e){for(var a,i,r=e[0],c=e[1],l=e[2],u=0,d=[];u<r.length;u++)i=r[u],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);p&&p(e);while(d.length)d.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],a=!0,i=1;i<n.length;i++){var r=n[i];0!==o[r]&&(a=!1)}a&&(s.splice(e--,1),t=c(c.s=n[0]))}return t}var a={},i={app:0},o={app:0},s=[];function r(t){return c.p+"js/"+({}[t]||t)+"."+{"chunk-24826294":"f856c047","chunk-2d0afaa8":"afc90e82","chunk-2d0c8672":"3e2e0b94","chunk-2d21007a":"115cd6a1","chunk-45e1ebaa":"e118dc11","chunk-827bf908":"5ade4999","chunk-a9a1ac52":"c53a9264","chunk-ef00e4e8":"1ece5fdc"}[t]+".js"}function c(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={"chunk-24826294":1,"chunk-45e1ebaa":1,"chunk-827bf908":1,"chunk-a9a1ac52":1,"chunk-ef00e4e8":1};i[t]?e.push(i[t]):0!==i[t]&&n[t]&&e.push(i[t]=new Promise((function(e,n){for(var a="css/"+({}[t]||t)+"."+{"chunk-24826294":"0e433876","chunk-2d0afaa8":"31d6cfe0","chunk-2d0c8672":"31d6cfe0","chunk-2d21007a":"31d6cfe0","chunk-45e1ebaa":"bb23083f","chunk-827bf908":"9a12b31b","chunk-a9a1ac52":"57d36ae9","chunk-ef00e4e8":"52a4f180"}[t]+".css",o=c.p+a,s=document.getElementsByTagName("link"),r=0;r<s.length;r++){var l=s[r],u=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(u===a||u===o))return e()}var d=document.getElementsByTagName("style");for(r=0;r<d.length;r++){l=d[r],u=l.getAttribute("data-href");if(u===a||u===o)return e()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=e,p.onerror=function(e){var a=e&&e.target&&e.target.src||o,s=new Error("Loading CSS chunk "+t+" failed.\n("+a+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=a,delete i[t],p.parentNode.removeChild(p),n(s)},p.href=o;var f=document.getElementsByTagName("head")[0];f.appendChild(p)})).then((function(){i[t]=0})));var a=o[t];if(0!==a)if(a)e.push(a[2]);else{var s=new Promise((function(e,n){a=o[t]=[e,n]}));e.push(a[2]=s);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,c.nc&&u.setAttribute("nonce",c.nc),u.src=r(t);var d=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var n=o[t];if(0!==n){if(n){var a=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+a+": "+i+")",d.name="ChunkLoadError",d.type=a,d.request=i,n[1](d)}o[t]=void 0}};var p=setTimeout((function(){l({type:"timeout",target:u})}),12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(e)},c.m=t,c.c=a,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)c.d(n,a,function(e){return t[e]}.bind(null,a));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="",c.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=e,l=l.slice();for(var d=0;d<l.length;d++)e(l[d]);var p=u;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"205f":function(t,e,n){"use strict";var a=n("939a"),i=n.n(a);i.a},"27a2":function(t,e,n){"use strict";var a=n("c831"),i=n.n(a);i.a},"292a":function(t,e,n){},"53e8":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("4917"),n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),i=n("a925"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"full-height",attrs:{id:"app"}},[t.$store.is_ready?n("div",{staticClass:"full-height"},[n("div",{staticClass:"row menu"},[n("div",{attrs:{selected:"home"==t.$route.name},on:{click:function(e){return t.$router.push({name:"home"})}}},[n("span",[t._v("Home")])]),t.$store.user?n("div",{attrs:{selected:"account"==t.$route.name},on:{click:function(e){return t.$router.push({name:"account"})}}},[n("span",[t._v("Account")])]):t._e(),t.$store.user&&t.$store.user.places.length?n("div",{attrs:{selected:["manage-places"].includes(t.$route.name)},on:{click:function(e){return t.$router.push({name:"manage-places"})}}},[n("span",[t._v("Places")])]):t._e(),t.$store.user&&t.$store.user.is_admin?n("div",{attrs:{selected:["admin"].includes(t.$route.name)},on:{click:function(e){return t.$router.push({name:"admin"})}}},[n("span",[t._v("Admin")])]):t._e()]),t.needs_login?n("login",{attrs:{id:"content"}}):t.is_allowed?n("div",{staticClass:"full-height-scroll",attrs:{id:"content"}},[n("router-view",{staticClass:"animate-fadein"})],1):n("div",{staticClass:"text-center is-middle pb-5",attrs:{id:"content"}},[n("h1",[t._v("Not Allowed")]),n("i",[t._v("You do not have the permissions to view this page")])])],1):n("loading-screen",[t._v("\n    Loading page...\n  ")])],1)},s=[],r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"is-middle text-center",staticStyle:{"padding-bottom":"30vh"}},[t.$store.user?n("div",[t._v("\n    You are logged in and you should not be seeing this page\n    "),n("button",{staticClass:"btn btn-danger",on:{click:function(e){return t.$store.logout()}}},[t._v("Logout")]),"facebook"==t.$store.user.auth_driver?n("a",{attrs:{target:"_blank",href:"https://www.facebook.com/app_scoped_user_id/"+t.$store.user.auth_id}},[t._v("Go to PROFILE")]):t._e()]):n("div",[n("h1",{staticClass:"nm"},[t._v("Login")]),n("br"),n("br"),t.is_loading?n("div",[t._v("\n      Loading...\n    ")]):n("div",[t._v("\n      You can login or signup using the button below\n      "),n("br"),n("br"),n("button",{staticClass:"btn",staticStyle:{background:"#3b5998",color:"#fff"},on:{click:function(e){return t.login_fb()}}},[t._v("\n        Login with Facebook\n      ")])])])])},c=[],l={data:function(){return{is_loading:!1}},mounted:function(){window.FB.init({appId:"2189561351345047",autoLogAppEvents:!1,xfbml:!1,version:"v4.0"})},methods:{login_fb:function(){var t=this;this.is_loading=!0,window.FB.getLoginStatus((function(){window.FB.login((function(e){e.authResponse?t.$store.loginWithDriver("facebook",null,e.authResponse.accessToken,{finally:function(){t.is_loading=!1}}):t.is_loading=!1}))}))}}},u=l,d=n("2877"),p=Object(d["a"])(u,r,c,!1,null,null,null),f=p.exports,m={components:{login:f},data:function(){return console.log(this.$bvModal.msgBoxOk),{modals:[{title:"Error",text:"ciao"}]}},created:function(){this.$store.root=this},computed:{needs_login:function(){return!this.$store.user&&this.$route.meta.auth},is_allowed:function(){return!this.$route.meta.admin||this.$store.user&&this.$store.user.is_admin}}},h=m,v=(n("5c0b"),Object(d["a"])(h,o,s,!1,null,null,null)),_=v.exports,g=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),b=n("8c4f"),k={is_ready:!1,user:null,$http:null,place_types:["homestay","residence","guesthouse","hostel","hotel"],place_perks:["coffee-tea","restaurant","bar","swimming-pool","pool-table"],room_perks:["ac","desk","private-bathroom","hot-shower","window","terrace"],bed_types:["single","double","single-bunk","double-bunk"],install:function(t){var e=this;this.$http=t.prototype.$http,this.refreshUser({finally:function(){return e.is_ready=!0}})},refreshUser:function(t){var e=this;t=t||{};var n=localStorage.getItem("token");return n?(this.updateToken(n),this.$http.get("user").then((function(n){e.updateUser(n.data),t.success&&t.success()}),(function(){e.updateUser(null),e.updateToken(null),t.fail&&t.fail()})).finally((function(){t.finally&&t.finally()})),!0):(t.fail&&t.fail(),t.finally&&t.finally(),!1)},loginWithDriver:function(t,e,n,a){var i=this;a=a||{},this.$http.post("login",{driver:t,id:e,token:n}).then((function(t){i.updateUser(t.data.user),i.updateToken(t.data.token),a.success&&a.success()}),(function(){i.updateUser(null),i.updateToken(null),a.fail&&a.fail()})).finally((function(){a.finally&&a.finally()}))},updateUser:function(t){this.user=t},updateToken:function(t){this.$http.defaults.headers.common["Authorization"]=t,localStorage.setItem("token",t||"")},logout:function(){this.updateToken(null),this.updateUser(null)}},y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-padded text-center"},[n("h4",{staticClass:"m-0"},[t._v("Welcome to")]),n("h1",{staticClass:"m-0"},[t._v("Flores Room")]),n("i",[t._v("Your finest cheapest room")]),n("div",{staticClass:"my-4"},[n("search-box")],1),t.$store.user?t._e():n("div",[t._m(0),n("button",{staticClass:"btn btn-primary my-3",on:{click:function(e){return t.$router.push({name:"account"})}}},[t._v("SIGN UP!")])]),t.$store.user&&t.$store.user.places.length?n("div",{staticClass:"mt-2"},[n("button",{staticClass:"btn btn-outline-primary",on:{click:function(e){return t.$router.push({name:"manage-places"})}}},[t._v("Manage your places!")])]):t._e()])},w=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v("\n      This project will allow local "),n("b",[t._v("guesthouses")]),t._v(" and "),n("b",[t._v("homestays")]),t._v(" to receive and manage\n      bookings "),n("b",[t._v("easily")]),t._v(" and with "),n("b",[t._v("minimal fees")]),t._v(".\n    ")])}],C={},$=C,x=Object(d["a"])($,y,w,!1,null,null,null),S=x.exports,O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.places?"view-result"==t.$route.name?n("div",[t.selected_place?n("view-place",{attrs:{src_place:t.selected_place,src_filters:t.filters}}):n("div",{staticClass:"p-5 text-center"},[t._v("\n    This place is not available anymore\n    "),n("br"),n("br"),n("button",{staticClass:"btn btn-outline-danger",on:{click:function(e){return t.$router.back()}}},[t._v("Go Back")])])],1):n("div",{staticClass:"page-places"},[n("div",{staticClass:"page-padded"},[n("h1",{staticClass:"mt-3 mb-2"},[t._v("Results")]),t.places?t.places.length?n("div",[t._v("\n      "+t._s(t.places.length)+" places found\n      ðŸ™‚\n\n    ")]):n("div",[t._v("\n      No places found ðŸ¥º\n\n      "),n("div",{staticClass:"mt-4 ml-3"},[n("button",{staticClass:"btn btn-outline-danger",on:{click:function(e){return t.$router.back()}}},[t._v("Go Back")])])]):n("div",[t._v("\n      Loading... ðŸ§\n    ")])]),t._l(t.places,(function(e){return n("div",{staticClass:"result row",on:{click:function(n){return t.$router.push({name:"view-result",params:{id:e.id},query:t.$route.query})}}},[n("div",{directives:[{name:"square",rawName:"v-square"}],staticClass:"col-5 res-pic",style:e.pics.length&&"background-image: url("+t.$utils.image_sm(e.pics[0])+")"}),n("div",{staticClass:"col res-info"},[n("div",{staticStyle:{"font-size":"1.1rem"}},[t._v(t._s(e.name))]),n("div",{staticClass:"small",staticStyle:{opacity:".7"}},[t._v("\n        "+t._s(e.loc_city)+",\n        "+t._s((e.distance||5*Math.random()).toFixed(1))+" km"),n("div",[t._v("Availability: "+t._s(e.rooms.reduce((function(t,e){return t+e.availability}),0))+" places")]),n("br")])]),n("b",{staticClass:"res-price"},[t._v(t._s(90+Math.floor(60*Math.random()))),n("span",{staticStyle:{"font-size":"70%"}},[t._v(".000 â‚¹")])])])}))],2):n("loading-screen",[t._v("\n  Loading places...\n")])},j=[],L=(n("7514"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.place?n("div",{staticClass:"page-view-place"},[n("div",{staticClass:"page-padded"},[n("h2",[t._v(t._s(t.place.name))]),n("div",{staticClass:"place-info"},[t._v("\n      "+t._s(t.place.loc_addr)+" - "+t._s(t.place.loc_city)+"\n      "),"distance"in t.place?n("span",[t._v("- "+t._s(t.place.distance.toFixed(1))+" km from you")]):t._e()])]),t.place.pics.length?n("swiper",{staticStyle:{background:"#222"},attrs:{options:{slidesPerView:1,spaceBetween:0,autoHeight:!0,pagination:{el:".swiper-pagination",type:"progressbar"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}}},[t._l(t.place.pics,(function(e){return n("swiper-slide",{key:e},[n("div",{directives:[{name:"square",rawName:"v-square",value:.6875,expression:"11/16"}],style:"margin: .5rem; background-size: contain; background-position: center center; background-repeat: no-repeat; background-image: url("+t.$utils.image_md(e)+")"})])})),t.place.pics.length>1?[n("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"}),n("div",{staticClass:"swiper-button-prev",attrs:{slot:"button-prev"},slot:"button-prev"}),n("div",{staticClass:"swiper-button-next",attrs:{slot:"button-next"},slot:"button-next"})]:t._e()],2):t._e(),n("div",{staticClass:"page-padded"},[t.place.perks.length?n("div",{staticClass:"mb-4"},[n("h3",[t._v("Features")]),t._l(t.place.perks,(function(e){return n("div",{key:e},[t._v("\n        âœ“ "+t._s(t.$t("place_perk."+e))+"\n      ")])}))],2):t._e()]),t.filters?n("div",{staticClass:"book"},[n("div",{staticClass:"book-header"},[n("div",{staticClass:"row align-items-center"},[n("div",{staticClass:"col"},[n("h3",{staticClass:"m-0"},[t._v("Booking")])]),n("div",{staticClass:"col text-center"},[t._v("\n          "+t._s(t.filters.n)+" people\n        ")]),n("div",{staticClass:"col text-center"},[t._v("\n          "+t._s(t.$d(t.$utc(t.filters.check_in)))+"\n          "),n("br"),t._v("\n          "+t._s(t.$d(t.$utc(t.filters.check_out)))+"\n        ")])])]),(t.private_rooms=t.place.rooms.filter((function(t){return!t.is_dorm}))).length?n("div",[n("div",{staticClass:"text-center my-2"},[n("h4",{staticClass:"nm"},[t._v("Private Rooms:")])]),t._l(t.private_rooms,(function(e){return n("div",{key:e.id,staticClass:"book-room"},[n("div",{staticClass:"row no-gutters"},[n("div",{staticClass:"col-5"},[n("b",{staticStyle:{"font-size":"1.1rem"}},[t._v(t._s(e.name))]),n("div",{staticClass:"room-shape"},[t._v("\n              Beds:\n              "),t._l(e.shape,(function(e,a){return n("div",{key:a,staticStyle:{display:"inline-block","font-size":"1rem","line-height":"1"}},[n("span",{staticStyle:{display:"inline-block","margin-right":".3rem","vertical-align":"bottom"}},[t._v(t._s(e)+"x")]),n("i",{class:"bed "+a,staticStyle:{display:"inline-block","font-size":"1.8rem","vertical-align":"bottom"}})])}))],2),t._l(e.perks,(function(e){return n("div",{key:e,staticClass:"perk small"},[t._v("\n              âœ“ "+t._s(t.$t("room_perk."+e))+"\n            ")])}))],2),t._l([1,2],(function(a){return(t.beds=e["av_b"+a])&&(t.price=e["b"+a+"_price"])?n("div",{key:a,staticClass:"col text-center ml-1"},[n("div",[n("div",{staticClass:"row no-gutters align-center"},[n("div",{staticClass:"col text-right"},[n("i",{class:{bed:!0,single:1==a,double:2==a},staticStyle:{"font-size":"2.6rem","margin-right":".5rem"}})]),n("div",{staticClass:"col text-left"},[n("span",[n("price",{attrs:{price:t.price}})],1),n("div",{staticClass:"small"},[t._v("max "+t._s(t.beds)+" beds")])])]),n("div",[n("input",{staticClass:"custom-range",staticStyle:{width:"100%"},attrs:{type:"range",min:0,max:Math.min(t.beds,t.filters.n)},domProps:{value:t.bookings[e.id][a]},on:{input:function(n){t.bookings[e.id][a]=1*n.target.value}}})]),(t.br=t.bookings[e.id])&&t.br[a]?n("div",[t._v("\n                "+t._s(t.br[a])),n("span",{staticClass:"small"},[t._v("x")]),t._v(" =\n                "),n("b",[n("price",{attrs:{price:t.br[a]*e["b"+a+"_price"]}})],1)]):t._e()])]):t._e()}))],2)])}))],2):t._e(),(t.dorms=t.place.rooms.filter((function(t){return t.is_dorm}))).length?n("div",[n("div",{staticClass:"text-center my-2"},[n("h4",{staticClass:"nm"},[t._v("Dorms:")])]),t._l(t.dorms,(function(e){return n("div",{key:e.id,staticClass:"book-room"},[n("div",{staticClass:"row no-gutters"},[n("div",{staticClass:"col-5"},[n("b",{staticStyle:{"font-size":"1.1rem"}},[t._v(t._s(e.name))]),n("div",{staticClass:"room-shape"},[t._v("\n              Beds:\n              "),t._l(e.shape,(function(e,a){return n("div",{key:a,staticStyle:{display:"inline-block","font-size":"1rem","line-height":"1"}},[n("span",{staticStyle:{display:"inline-block","margin-right":".3rem","vertical-align":"bottom"}},[t._v(t._s(e)+"x")]),n("i",{class:"bed "+a,staticStyle:{display:"inline-block","font-size":"1.8rem","vertical-align":"bottom"}})])}))],2),t._l(e.perks,(function(e){return n("div",{key:e,staticClass:"perk small"},[t._v("\n              âœ“ "+t._s(t.$t("room_perk."+e))+"\n            ")])}))],2),t._l([1,2],(function(a){return(t.beds=e["av_b"+a])&&(t.price=e["b"+a+"_price"])?n("div",{key:a,staticClass:"col text-center ml-1"},[n("div",[n("div",{staticClass:"row no-gutters align-center"},[n("div",{staticClass:"col text-right"},[n("i",{class:{bed:!0,single:1==a,double:2==a},staticStyle:{"font-size":"2.6rem","margin-right":".5rem"}})]),n("div",{staticClass:"col text-left"},[n("span",[n("price",{attrs:{price:t.price}})],1),n("div",{staticClass:"small"},[t._v("max "+t._s(t.beds)+" beds")])])]),n("div",[n("input",{staticClass:"custom-range",staticStyle:{width:"100%"},attrs:{type:"range",min:0,max:Math.min(t.beds,t.filters.n)},domProps:{value:t.bookings[e.id][a]},on:{input:function(n){t.bookings[e.id][a]=1*n.target.value}}})]),(t.br=t.bookings[e.id])&&t.br[a]?n("div",[t._v("\n                "+t._s(t.br[a])),n("span",{staticClass:"small"},[t._v("x")]),t._v(" =\n                "),n("b",[n("price",{attrs:{price:t.br[a]*e["b"+a+"_price"]}})],1)]):t._e()])]):t._e()}))],2)])}))],2):t._e(),n("div",{staticClass:"checkout"},[n("h2",[t._v("Checkout")]),t.location.hostname.match(/\.com$/)?n("div",[t._v("\n        Checkout has not been implemented yet\n      ")]):t.booking?n("div",[n("div",{staticClass:"row mb-2"},[n("div",{staticClass:"col"},[t._v("\n            Total price: "),n("b",[n("price",{attrs:{price:t.booking.total}})],1)]),n("div",{staticClass:"col"},[t._v("\n            People: "+t._s(t.booking.people)+"\n          ")])]),n("div",{staticClass:"my-4"},[t._v("\n          Payment method:\n          "),n("select",{staticClass:"form-control"},[n("optgroup",{attrs:{label:"Saved cards"}},[n("option",[t._v("Mastercard *0984")]),n("option",[t._v("Visa *3283")])]),n("optgroup",{attrs:{label:"New Method"}},[n("option",[t._v("Credit Card")]),n("option",[t._v("Paypal")])])])]),n("div",{staticClass:"text-right"},[n("button",{staticClass:"btn btn-primary",on:{click:t.checkout}},[t._v("Checkout")])])]):n("div",[t._v("\n        Select the beds/rooms you want\n      ")])])]):t._e()],1):n("loading-screen",[t._v("\n  Loading details...\n")])}),P=[],E={props:{src_place:{type:Object},src_filters:{type:Object}},data:function(){return{place:this.src_place,filters:this.src_filters,bookings:null,location:location}},created:function(){},computed:{booking:function(){var t=this,e={},n=0,a=0,i=this.bookings,o=function(o){for(var s in i[o]){var r=i[o][s];e[s]=(e[s]||0)+r;var c=t.place.rooms.find((function(t){return t.id==o}));a+="room"==s?c.price*r:c["b".concat(s,"_price")]*r,n+="room"==s?r*(c.b1_count+2*c.b2_count):r*s}};for(var s in i)o(s);if(a)return{place_id:this.place.id,check_in:this.filters.check_in,check_out:this.filters.check_out,total:a,counts:e,people:n,bookings:i}}},methods:{checkout:function(){this.$http.post("bookings",this.booking).then((function(t){console.log("Fatto!",t)}))}},watch:{src_place:function(t){this.place=t},"place.rooms":{immediate:!0,handler:function(t){var e={};t.forEach((function(t){return e[t.id]={1:0,2:0,room:0}})),this.bookings=e}}}},D=E,T=(n("205f"),Object(d["a"])(D,L,P,!1,null,null,null)),N=T.exports,M={components:{ViewPlace:N},data:function(){return{places:null}},computed:{filters:function(){return this.$utils.unpack(this.$route.query.q)},selected_place:function(){var t=this.$route.params.id;return t?(this.places||[]).find((function(e){return e.id==t})):null}},methods:{reloadResults:function(){var t=this;this.places=null;var e=this.filters,n={distance_from:{lat:e.lat,lon:e.lon},availability:{n:e.n,check_in:e.check_in,check_out:e.check_out},order_by:"distance"};this.$http.get("places",{params:n}).then((function(e){t.places=e.data}))}},watch:{filters:{immediate:!0,handler:function(t,e){e&&JSON.stringify(t)==JSON.stringify(e)||(console.log(JSON.stringify(t)+"\n"+JSON.stringify(e)),this.reloadResults())}}}},q=M,B=(n("27a2"),Object(d["a"])(q,O,j,!1,null,null,null)),z=B.exports;function U(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function R(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?U(n,!0).forEach((function(e){Object(g["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}a["a"].use(b["a"]);var F=new b["a"]({mode:"hash",base:"",routes:[{path:"/",name:"home",component:S},{path:"/admin",name:"admin",component:function(){return n.e("chunk-2d0afaa8").then(n.bind(null,"0efc"))},meta:{auth:!0,admin:!0}},{path:"/account",name:"account",component:function(){return n.e("chunk-2d21007a").then(n.bind(null,"b5c4"))},meta:{auth:!0}},{path:"/host",name:"host",component:function(){return n.e("chunk-2d0c8672").then(n.bind(null,"5573"))},meta:{auth:!0}},{path:"/places",name:"manage-places",component:function(){return n.e("chunk-a9a1ac52").then(n.bind(null,"b601"))},meta:{auth:!0}},{path:"/places/:id/manage",name:"manage-place",component:function(){return n.e("chunk-24826294").then(n.bind(null,"3f63"))},meta:{auth:!0},children:[{path:"rooms",name:"manage-rooms",component:function(){return n.e("chunk-ef00e4e8").then(n.bind(null,"8fea"))},meta:{auth:!0}},{path:"rooms/:room_id?/edit",name:"edit-room",component:function(){return n.e("chunk-45e1ebaa").then(n.bind(null,"6cb3"))},meta:{auth:!0}}]},{path:"/places/:id?/edit",name:"edit-place",component:function(){return n.e("chunk-827bf908").then(n.bind(null,"3499"))},meta:{auth:!0}},{path:"/results/",name:"results",component:z,children:[{path:"detail/:id",name:"view-result"}]}]});F.beforeEach((function(t,e,n){if(!t.meta.middleware)return n();var a=t.meta.middleware,i={to:t,from:e,next:n,store:k};return a[0](R({},i))}));var I=F,Y=n("bc3a"),A=n.n(Y),J=n("4328"),H=n.n(J),V={api_url:"//"+("localhost"==location.hostname?"floresroom.x":location.hostname)+"/api/"},G=(n("a481"),{compress:function(t){return btoa(t)},decompress:function(t){return atob(t)}}),W={unpack:function(t){return JSON.parse(G.decompress(t,{inputEncoding:"Base64"}))},pack:function(t){return G.compress(JSON.stringify(t),{outputEncoding:"Base64"})},rand_str:function(t,e){e=e||"QWERTYUIOPLKJHGFDSAZXCVBNMqwertyuioplkjhgfdsazxcvbnm1234567890";var n="";while(n.length<10)n+=e[Math.floor(Math.random()*e.length)];return n},clone:function(t){return JSON.parse(JSON.stringify(t))},image_lg:function(t){return V.api_url+"../storage/"+t+"-lg.jpg"},image_md:function(t){return V.api_url+"../storage/"+t+"-md.jpg"},image_sm:function(t){return V.api_url+"../storage/"+t+"-sm.jpg"},resizeImage:function(t,e){var n=new Image,a=1e3,i=1e3;n.onload=function(){var t=document.createElement("canvas"),o=t.getContext("2d"),s=n.width,r=n.height,c=Math.min(a/s,i/r),l=s*c,u=r*c;t.width=l,t.height=u,o.drawImage(n,0,0,l,u),t.toDataURL&&e(t.toDataURL("image/jpeg",.85).replace("data:image/jpeg;base64,",""))},console.log(t),n.src=URL.createObjectURL(t)}},K={locale:"en",messages:{en:{place_type:{homestay:"Homestay",residence:"Residence",guesthouse:"Guesthouse",hostel:"Hostel",hotel:"Hotel"},room_type:{private:"Private room",dorm:"Dorm"},place_perk:{"coffee-tea":"Free coffee & tea",restaurant:"Restaurant",bar:"Bar","swimming-pool":"Swimming pool","pool-table":"Pool table"},room_perk:{ac:"Air conditioner",desk:"Desk & chair","private-bathroom":"Private bathroom","hot-shower":"Hot shower",window:"Window",terrace:"Terrace"},bed_type:{single:"Single",double:"Double","single-bunk":"Single bunk","double-bunk":"Double bunk"},bed_price:{1:"Single bed price",2:"Double bed price"}}}},Q=(n("20d6"),n("768b")),X=[],Z=function(t,e){t.style.height=t.clientWidth*(e||1)+"px"};window.addEventListener("resize",(function(){X.forEach((function(t){var e=Object(Q["a"])(t,2),n=e[0],a=e[1];return Z(n,a.value)}))})),a["a"].directive("square",{inserted:function(t,e){X.push([t,e]),Z(t,e.value)},unbind:function(t){var e=X.findIndex((function(e){return e[0]===t}));X.splice(e,1)}});var tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group justify-center"},[t._m(0),n("input",{directives:[{name:"model",rawName:"v-model",value:t.price,expression:"price"}],staticClass:"form-control text-right",staticStyle:{"max-width":"3rem"},attrs:{type:"number",max:"150",min:"0"},domProps:{value:t.price},on:{input:function(e){e.target.composing||(t.price=e.target.value)}}}),t._m(1)])},et=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("â‚¹")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group-append"},[n("span",{staticClass:"input-group-text",staticStyle:{"padding-left":".3rem"}},[t._v(".000")])])}],nt={props:["value"],computed:{price:{get:function(){return parseInt(this.value/1e3)||""},set:function(t){this.$emit("input",1e3*(parseInt(t)||0))}}}},at=nt,it=Object(d["a"])(at,tt,et,!1,null,null,null),ot=it.exports,st=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[t._v(t._s(parseInt(t.price/1e3))),n("span",{staticStyle:{"font-size":"70%"}},[t._v("kâ‚¹")])])},rt=[],ct=(n("c5f6"),{props:{price:{type:Number,default:0}}}),lt=ct,ut=Object(d["a"])(lt,st,rt,!1,null,null,null),dt=ut.exports,pt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"search-box"},[n("form",{on:{submit:function(e){return e.preventDefault(),t.search(e)}}},[n("h3",{staticClass:"mb-2"},[t._v("Your Search")]),n("div",{staticClass:"text-left row no-gutters"},[n("div",{staticClass:"col"},[t._v("\n        Location\n        "),n("location-input",{attrs:{lat:t.form.lat,lon:t.form.lon,"bounding-box":t.form.bounding_box},on:{"update:lat":function(e){return t.$set(t.form,"lat",e)},"update:lon":function(e){return t.$set(t.form,"lon",e)},"update:boundingBox":function(e){return t.$set(t.form,"bounding_box",e)},"update:bounding-box":function(e){return t.$set(t.form,"bounding_box",e)}},model:{value:t.form.display_name,callback:function(e){t.$set(t.form,"display_name",e)},expression:"form.display_name"}})],1),n("div",{staticClass:"col-3 pl-3"},[t._v("\n        People\n        "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.n,expression:"form.n"}],staticClass:"form-control",attrs:{type:"number",min:"0"},domProps:{value:t.form.n},on:{input:function(e){e.target.composing||t.$set(t.form,"n",e.target.value)}}})])]),n("div",{staticClass:"text-left"},[n("div",{staticClass:"row no-gutters"},[n("div",{staticClass:"col-6 pr-2"},[n("span",[t._v("Check in")]),n("date-picker",{staticStyle:{width:"100%"},attrs:{lang:t.$i18n.locale,"input-class":"form-control","first-day-of-week":1,format:"DD MMM YYYY","not-before":new Date,"value-type":{value2date:function(e){return t.$utc(e)},date2value:function(t){return t.toStdLocal()}}},model:{value:t.form.check_in,callback:function(e){t.$set(t.form,"check_in",e)},expression:"form.check_in"}})],1),n("div",{staticClass:"col-6 pl-2"},[n("span",[t._v("Check out")]),n("date-picker",{ref:"checkout",staticStyle:{width:"100%"},attrs:{lang:t.$i18n.locale,"input-class":"form-control","first-day-of-week":1,format:"DD MMM YYYY","not-before":t.$utc(t.form.check_in),"value-type":{value2date:function(e){return t.$utc(e)},date2value:function(t){return t.toStdLocal()}}},model:{value:t.form.check_out,callback:function(e){t.$set(t.form,"check_out",e)},expression:"form.check_out"}})],1)])]),n("div",{staticClass:"my-2"},[t.form.lat?n("i",[t._v("Â ")]):n("i",[t._v("Select a location from the list")])]),n("button",{staticClass:"btn btn-outline-primary",attrs:{type:"submit",disabled:!t.is_search_valid}},[t._v("\n      Search!\n    ")])])])},ft=[],mt=(n("28a5"),n("ea76")),ht=n.n(mt),vt={components:{DatePicker:ht.a},data:function(){var t=localStorage.last_search&&JSON.parse(localStorage.last_search),e=t||{};return(!e.check_in||e.check_in<(new Date).toStdLocal())&&(e.check_in=(new Date).toStdLocal()),e.n||(e.n=2),{console:console,form:e}},computed:{is_search_valid:function(){return this.form.check_in&&this.form.check_out&&this.form.lat&&this.form.lon&&this.form.n>0}},methods:{beautifyLocation:function(t){return(t.display_name||"").split(",").slice(0,2).join(",")},search:function(){localStorage.setItem("last_search",JSON.stringify(this.form)),this.$router.push({name:"results",query:{q:this.$utils.pack(this.form)}})}},watch:{"form.check_in":{immediate:!0,handler:function(t){(!this.form.check_out||t>=this.form.check_out)&&this.$set(this.form,"check_out",this.$utc(t).nextDay().toStdLocal()),this.$refs.checkout&&this.$refs.checkout.$el.querySelector("input").focus(),this.$refs.checkout&&this.$refs.checkout.showPopup()}}}},_t=vt,gt=(n("b7fb"),Object(d["a"])(_t,pt,ft,!1,null,null,null)),bt=gt.exports,kt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cp-loading text-center is-middle"},[t._t("default",[t._v("Loading...")])],2)},yt=[],wt={},Ct=wt,$t=(n("8233"),Object(d["a"])(Ct,kt,yt,!1,null,null,null)),xt=$t.exports,St=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"location-input"},[n("vue-bootstrap-typeahead",{ref:"loc_search",attrs:{serializer:t.beautifyLocation,data:t.suggestions},on:{hit:function(e){return t.setLocation(e)}},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}}),n("i",{staticStyle:{"font-size":".9rem"}},[t._v("Â \n    "),t.is_loading?[t._v("Loading...")]:t.is_empty?[t._v("No results")]:t._e()],2)],1)},Ot=[],jt=n("d45f"),Lt={components:{VueBootstrapTypeahead:jt["a"]},props:{value:{type:String,default:""}},data:function(){return{query:this.value,suggestions:[],is_loading:!1,is_empty:!1,cancel_token:null,load_to:null,watch:!0}},mounted:function(){var t=this;this.$refs.loc_search.inputValue=this.query,this.$nextTick((function(){t.watch=!0}))},methods:{beautifyLocation:function(t){return(t.display_name||"").split(",").slice(0,2).join(",")},updateLocSuggestions:function(t){var e=this;this.load_to&&clearTimeout(this.load_to),this.load_to=setTimeout((function(){if(t){e.is_loading=!0;var n={format:"json",q:t,addressdetails:0,countrycodes:"id"};e.cancel_token&&e.cancel_token.cancel(),e.cancel_token=e.$http.CancelToken.source(),console.log("query location",t),e.$http.get("https://nominatim.openstreetmap.org/search",{cancelToken:e.cancel_token.token,params:n}).then((function(t){e.suggestions=t.data,e.is_empty=!t.data.length})).finally((function(){e.is_loading=!1}))}}),500)},setLocation:function(t){var e=this;this.cancel_token&&this.cancel_token.cancel(),this.load_to&&clearTimeout(this.load_to),this.$emit("input",this.beautifyLocation(t)),this.$emit("update:lat",1*t.lat),this.$emit("update:lon",1*t.lon),this.$emit("update:bounding-box",t.boundingBox),this.watch=!1,this.$nextTick((function(){e.watch=!0}))}},watch:{query:function(t){this.watch&&this.updateLocSuggestions(t)}}},Pt=Lt,Et=(n("656d"),Object(d["a"])(Pt,St,Ot,!1,null,null,null)),Dt=Et.exports;a["a"].component("price",dt),a["a"].component("price-input",ot),a["a"].component("search-box",bt),a["a"].component("loading-screen",xt),a["a"].component("location-input",Dt);var Tt=n("7212"),Nt=n.n(Tt),Mt=(n("dfa4"),n("88eb"));a["a"].use(Nt.a),a["a"].use(Mt["a"]);n("5d61");a["a"].config.productionTip=!1,A.a.defaults.baseURL=V.api_url,a["a"].prototype.$http=A.a,A.a.interceptors.request.use((function(t){return t.paramsSerializer=function(t){return H.a.stringify(t,{arrayFormat:"brackets",encode:!1})},t})),A.a.interceptors.response.use((function(t){return t}),(function(t){console.log(t),window.err=t;var e="";return e=t.response?t.response.data.message?t.response.data.message:t.message||"Connection error":t.message,k.root.$bvModal.msgBoxOk(e,{title:"Error!",size:"sm",okVariant:"danger",headerClass:"p-2  text-center border-bottom-0 text-danger",bodyClass:"py-1 px-2 text-center ",footerClass:"p-2 border-top-0 text-center ",centered:!0}),Promise.reject(t)})),a["a"].prototype.$store=window.$store=k,a["a"].prototype.$utils=window.$utils=W,a["a"].prototype.$config=window.$config=V,a["a"].prototype.$utc=function(t){if(!t)return new Date;var e=t.match(/\d+/g);return new Date(Date.UTC(e[0],e[1]-1,e[2],e[3]||0,e[4]||0,e[5]||0))},Date.prototype.toStdLocal=function(){return this.getFullYear()+"-"+("00"+(this.getMonth()+1)).slice(-2)+"-"+("00"+this.getDate()).slice(-2)},Date.prototype.nextDay=function(){return new Date(this.getTime()+864e5)},a["a"].use(k),a["a"].use(i["a"]),window.Vue=a["a"],window.vue=new a["a"]({i18n:new i["a"](K),data:{store:k,config:V},router:I,render:function(t){return t(_)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var a=n("e332"),i=n.n(a);i.a},"5d61":function(t,e,n){},"656d":function(t,e,n){"use strict";var a=n("292a"),i=n.n(a);i.a},7511:function(t,e,n){},8233:function(t,e,n){"use strict";var a=n("53e8"),i=n.n(a);i.a},"939a":function(t,e,n){},b7fb:function(t,e,n){"use strict";var a=n("7511"),i=n.n(a);i.a},c831:function(t,e,n){},e332:function(t,e,n){}});
//# sourceMappingURL=app.c3740df4.js.map