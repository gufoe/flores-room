(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b8f0ca26"],{3499:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.form?a("div",{staticClass:"page-place-form mx-2"},[a("div",{staticClass:"text-center"},[a("h2",[t._v(t._s(t.form.id?"Edit":"Create")+" Place")])]),a("form",{on:{submit:function(e){return e.preventDefault(),t.save(e)}}},[a("fieldset",{staticClass:"form-group"},[a("legend",{staticClass:"legend"},[t._v("Basic Info")]),a("div",{staticClass:"my-form-row"},[t._v("\n        Name\n        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}})]),a("div",{staticClass:"my-form-row"},[t._v("\n        Type\n        "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.form.type,expression:"form.type"}],staticClass:"form-control",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.form,"type",e.target.multiple?a:a[0])}}},t._l(t.$store.place_types,(function(e){return a("option",{key:e,domProps:{value:e}},[t._v(t._s(t.$t("place_type."+e)))])})),0)])]),a("fieldset",{staticClass:"form-group"},[a("legend",{staticClass:"legend"},[t._v("Address")]),a("div",{directives:[{name:"square",rawName:"v-square",value:.5,expression:".5"}],staticClass:"my-form-row",staticStyle:{"min-height":"50vh"}},[a("location-picker",{attrs:{city:t.form.loc_city,addr:t.form.loc_addr,lat:t.form.loc_lat,lon:t.form.loc_lon,with_addr:!0},on:{"update:city":function(e){return t.$set(t.form,"loc_city",e)},"update:addr":function(e){return t.$set(t.form,"loc_addr",e)},"update:lat":function(e){return t.$set(t.form,"loc_lat",e)},"update:lon":function(e){return t.$set(t.form,"loc_lon",e)},addr:function(e){t.$set(t.form,"loc_city",e.village||e.city||e.state),t.$set(t.form,"loc_addr",e.road)}}})],1),a("div",{staticClass:"my-form-row mt-1"},[t._v("\n        City\n        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.loc_city,expression:"form.loc_city"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.form.loc_city},on:{input:function(e){e.target.composing||t.$set(t.form,"loc_city",e.target.value)}}})]),a("div",{staticClass:"my-form-row"},[t._v("\n        Road\n        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.loc_addr,expression:"form.loc_addr"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.form.loc_addr},on:{input:function(e){e.target.composing||t.$set(t.form,"loc_addr",e.target.value)}}})])]),a("fieldset",{staticClass:"form-group"},[a("legend",{staticClass:"legend"},[t._v("Images ("+t._s(t.form.pics.length)+")")]),a("div",{staticClass:"my-form-row"},[a("div",{staticStyle:{width:"100%"}},[t.form.pics.length?a("swiper",{staticStyle:{margin:"10px -1rem"},attrs:{options:{slidesPerView:1,spaceBetween:0,autoHeight:!0,pagination:{el:".swiper-pagination",type:"progressbar"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}}},[t._l(t.form.pics,(function(e){return a("swiper-slide",{key:e,staticStyle:{"background-color":"#222"}},[a("div",{directives:[{name:"square",rawName:"v-square",value:9/16,expression:"9/16"}],style:"margin: 1rem; background-size: contain; background-position: center center; background-repeat: no-repeat; background-image: url("+t.$utils.image_md(e)+")"},[a("div",{staticClass:"btn-del"})])])})),a("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"}),a("div",{staticClass:"swiper-button-prev",attrs:{slot:"button-prev"},slot:"button-prev"}),a("div",{staticClass:"swiper-button-next",attrs:{slot:"button-next"},slot:"button-next"})],2):t._e(),t.uploading_files.length?a("div",[t._v("Uploading "+t._s(t.uploading_files.length)+" files...")]):t._e(),a("div",{},[a("button",{staticClass:"btn btn-outline-primary",attrs:{type:"button"},on:{click:function(e){return t.addImages()}}},[t._v("Add images")])])],1)])]),a("fieldset",{staticClass:"form-group"},[a("legend",{staticClass:"legend"},[t._v("Features")]),t._l(t.$store.place_perks,(function(e){return a("div",{key:e,staticClass:"my-form-row"},[a("label",[a("input",{attrs:{type:"checkbox"},domProps:{checked:t.form.perks.includes(e)},on:{change:function(a){t.form.perks.includes(e)?t.form.perks.splice(t.form.perks.indexOf(e),1):t.form.perks.push(e)}}}),t._v("\n          "+t._s(t.$t("place_perk."+e))+"\n        ")])])}))],2),a("div",{staticClass:"text-center my-4"},[a("button",{staticClass:"btn btn-danger",attrs:{disabled:t.is_saving,type:"button"},on:{click:function(e){return e.preventDefault(),t.$router.back()}}},[t._v("Back")]),t._v("\n      Â \n      "),a("button",{staticClass:"btn btn-primary",attrs:{disabled:t.is_saving,type:"submit"}},[t._v("Save")])])])]):a("loading-screen",[t._v("\n  Loading...\n")])},o=[],i=(a("a481"),a("d012")),n={components:{locationPicker:i["a"]},data:function(){return{form:null,is_saving:!1,uploading_files:[]}},methods:{initForm:function(){var t=this,e=this.$route.params.id;e?(this.form=null,this.$http.get("places/".concat(e)).then((function(e){t.form=e.data}))):this.form={perks:[],pics:[],images:[],loc_city:"",loc_addr:"",loc_lat:0,loc_lon:0}},addImages:function(){var t=this,e=document.createElement("input");e.type="file",e.accept="image/*",e.multiple=1,e.onchange=function(e){console.log(e.target.files);for(var a=0;a<e.target.files.length;a++)t.$utils.resizeImage(e.target.files[a],(function(e){var a={uploaded:0,size:e.length};t.uploading_files.push(a),t.$http.post("files/image",{base64:e}).then((function(e){t.form.pics.push(e.data)})).finally((function(){var e=t.uploading_files.indexOf(a);console.log("removing",e,a),t.uploading_files.splice(e,1)}))}))},e.click()},save:function(){var t=this;this.is_saving=!0,this.$http.post("places",this.form).then((function(e){t.form.user_id==t.$store.user.id&&t.$store.refreshUser(),t.form.id?t.$router.push({name:"manage-place",params:{id:e.data.id}}):t.$router.replace({name:"edit-room",params:{id:e.data.id}})})).finally((function(){t.is_saving=!1}))}},watch:{"$route.params.id":{immediate:!0,handler:function(){this.initForm()}}}},r=n,l=(a("ae5c"),a("2877")),c=Object(l["a"])(r,s,o,!1,null,null,null);e["default"]=c.exports},ae5c:function(t,e,a){"use strict";var s=a("e903"),o=a.n(s);o.a},e903:function(t,e,a){}}]);
//# sourceMappingURL=chunk-b8f0ca26.a9539ee1.js.map